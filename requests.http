### OCC API V2 - REST Client Tests
### Use a extensão REST Client do VSCode para executar estas requisições

@baseUrl = http://localhost:3001/api
@adminToken = SEU_TOKEN_ADMIN_AQUI
@clientToken = SEU_TOKEN_CLIENTE_AQUI

### ============================================
### HEALTH CHECK
### ============================================

### Health Check
GET {{baseUrl}}/health

### ============================================
### AUTENTICAÇÃO DE ADMINISTRADORES
### ============================================

### Login Admin
POST {{baseUrl}}/admin/login
Content-Type: application/json

{
  "email": "admin@occ.com.br",
  "password": "admin123"
}

### Obter dados do admin autenticado
GET {{baseUrl}}/admin/me
Authorization: Bearer {{adminToken}}

### Renovar token admin
POST {{baseUrl}}/admin/refresh
Content-Type: application/json

{
  "refreshToken": "SEU_REFRESH_TOKEN_ADMIN"
}

### ============================================
### AUTENTICAÇÃO DE CLIENTES
### ============================================

### Login Cliente
POST {{baseUrl}}/client-auth/login
Content-Type: application/json

{
  "email": "cliente@empresa.com",
  "password": "cliente123"
}

### Obter dados do cliente autenticado
GET {{baseUrl}}/client-auth/me
Authorization: Bearer {{clientToken}}

### Atualizar perfil do cliente
PUT {{baseUrl}}/client-auth/profile
Authorization: Bearer {{clientToken}}
Content-Type: application/json

{
  "name": "João Silva Atualizado",
  "company_name": "Empresa XYZ Eireli",
  "regime_tributario": "Lucro Presumido"
}

### Alterar senha do cliente
PUT {{baseUrl}}/client-auth/change-password
Authorization: Bearer {{clientToken}}
Content-Type: application/json

{
  "currentPassword": "senha123",
  "newPassword": "novaSenha456"
}

### Renovar token cliente
POST {{baseUrl}}/client-auth/refresh
Content-Type: application/json

{
  "refreshToken": "SEU_REFRESH_TOKEN_CLIENTE"
}

### ============================================
### GESTÃO DE CLIENTES (ADMIN)
### ============================================

### Listar clientes
GET {{baseUrl}}/admin/clients?page=1&limit=10
Authorization: Bearer {{adminToken}}

### Buscar cliente por ID
GET {{baseUrl}}/admin/clients/UUID_DO_CLIENTE
Authorization: Bearer {{adminToken}}

### Criar cliente
POST {{baseUrl}}/admin/clients
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Maria Santos",
  "email": "maria@empresa.com",
  "password": "senha123",
  "company_name": "Empresa ABC Ltda",
  "cnpj": "98765432109876",
  "regime_tributario": "Simples Nacional"
}

### Atualizar cliente
PUT {{baseUrl}}/admin/clients/UUID_DO_CLIENTE
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Maria Santos Silva",
  "email": "maria.silva@empresa.com",
  "company_name": "Empresa ABC Eireli",
  "regime_tributario": "Lucro Presumido"
}

### Deletar cliente
DELETE {{baseUrl}}/admin/clients/UUID_DO_CLIENTE
Authorization: Bearer {{adminToken}}

### ============================================
### GESTÃO DE ADMINISTRADORES (SUPER_ADMIN)
### ============================================

### Listar administradores (apenas SUPER_ADMIN)
GET {{baseUrl}}/admin/admins
Authorization: Bearer {{adminToken}}

### Buscar administrador por ID (apenas SUPER_ADMIN)
GET {{baseUrl}}/admin/admins/UUID_DO_ADMIN
Authorization: Bearer {{adminToken}}

### Criar administrador (apenas SUPER_ADMIN)
POST {{baseUrl}}/admin/admins
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Novo Administrador",
  "email": "novo.admin@occ.com.br",
  "password": "senha123"
}

### Atualizar administrador (apenas SUPER_ADMIN)
PUT {{baseUrl}}/admin/admins/UUID_DO_ADMIN
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Administrador Atualizado",
  "email": "admin.atualizado@occ.com.br"
}

### Deletar administrador (apenas SUPER_ADMIN)
DELETE {{baseUrl}}/admin/admins/UUID_DO_ADMIN
Authorization: Bearer {{adminToken}}

### ============================================
### CATEGORIAS
### ============================================

### Listar categorias
GET {{baseUrl}}/categories

### Criar categoria (Admin)
POST {{baseUrl}}/categories
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Tributário",
  "slug": "tributario"
}

### ============================================
### POSTS (BLOG)
### ============================================

### Listar posts
GET {{baseUrl}}/posts?page=1&limit=10

### Listar apenas posts publicados
GET {{baseUrl}}/posts?published=true

### Buscar post por ID
GET {{baseUrl}}/posts/UUID_DO_POST

### Buscar post por slug
GET {{baseUrl}}/posts/slug/meu-primeiro-post

### Criar post (Admin)
POST {{baseUrl}}/posts
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "title": "Como otimizar impostos na sua empresa",
  "slug": "como-otimizar-impostos",
  "content": "<p>Neste artigo, vamos explorar estratégias para otimização tributária...</p>",
  "cover_image": "https://exemplo.com/imagem.jpg",
  "category_id": "UUID_DA_CATEGORIA",
  "published": true
}

### Atualizar post (Admin)
PUT {{baseUrl}}/posts/UUID_DO_POST
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "title": "Título atualizado",
  "published": true
}

### Deletar post (Admin)
DELETE {{baseUrl}}/posts/UUID_DO_POST
Authorization: Bearer {{adminToken}}

### ============================================
### DOCUMENTOS
### ============================================

### Listar documentos do cliente
GET {{baseUrl}}/clients/UUID_DO_CLIENTE/documents
Authorization: Bearer {{adminToken}}

### Upload de documento (Admin)
POST {{baseUrl}}/clients/UUID_DO_CLIENTE/documents
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "title": "Contrato Social",
  "file_url": "https://storage.supabase.co/seu-bucket/contrato.pdf"
}

### Deletar documento (Admin)
DELETE {{baseUrl}}/clients/UUID_DO_CLIENTE/documents/UUID_DO_DOCUMENTO
Authorization: Bearer {{adminToken}}

### ============================================
### PESQUISAS
### ============================================

### Listar pesquisas ativas (Cliente)
GET {{baseUrl}}/surveys?is_active=true
Authorization: Bearer {{clientToken}}

### Buscar pesquisa com perguntas (Cliente)
GET {{baseUrl}}/surveys/UUID_DA_PESQUISA
Authorization: Bearer {{clientToken}}

### Criar pesquisa (Admin)
POST {{baseUrl}}/surveys
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "title": "Pesquisa de Satisfação 2024",
  "description": "Gostaríamos de saber sua opinião sobre nossos serviços",
  "is_active": true,
  "questions": [
    {
      "question_text": "Como você avalia nosso atendimento?",
      "type": "RATING",
      "order": 1
    },
    {
      "question_text": "Qual serviço você mais utiliza?",
      "type": "ALTERNATIVA",
      "options": ["Contabilidade", "Tributário", "Trabalhista", "Societário"],
      "order": 2
    },
    {
      "question_text": "Sugestões de melhoria:",
      "type": "DISSERTATIVA",
      "order": 3
    }
  ]
}

### Responder pesquisa (Cliente)
POST {{baseUrl}}/surveys/UUID_DA_PESQUISA/responses
Authorization: Bearer {{clientToken}}
Content-Type: application/json

{
  "answers": [
    {
      "question_id": "UUID_PERGUNTA_1",
      "answer_text": "5"
    },
    {
      "question_id": "UUID_PERGUNTA_2",
      "answer_text": "Contabilidade"
    },
    {
      "question_id": "UUID_PERGUNTA_3",
      "answer_text": "Melhorar o tempo de resposta aos emails"
    }
  ]
}

### Listar respostas da pesquisa (Admin)
GET {{baseUrl}}/surveys/UUID_DA_PESQUISA/responses
Authorization: Bearer {{adminToken}}

### Atualizar pesquisa (Admin)
PUT {{baseUrl}}/surveys/UUID_DA_PESQUISA
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "is_active": false
}

### ============================================
### Plan. Tributário
### ============================================

### Listar planejamentos (Cliente)
GET {{baseUrl}}/tax-plans
Authorization: Bearer {{clientToken}}

### Listar planejamentos por ano (Cliente)
GET {{baseUrl}}/tax-plans?year=2024
Authorization: Bearer {{clientToken}}

### Buscar planejamento específico (Cliente)
GET {{baseUrl}}/tax-plans/UUID_DO_PLANEJAMENTO
Authorization: Bearer {{clientToken}}

### Criar planejamento (Admin)
POST {{baseUrl}}/tax-plans
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "client_id": "UUID_DO_CLIENTE",
  "year": 2024
}

### Adicionar receita (Cliente)
POST {{baseUrl}}/tax-plans/UUID_DO_PLANEJAMENTO/revenues
Authorization: Bearer {{clientToken}}
Content-Type: application/json

{
  "description": "Venda de produtos",
  "amount": 50000.00,
  "date": "2024-01-15T00:00:00Z"
}

### Adicionar despesa (Cliente)
POST {{baseUrl}}/tax-plans/UUID_DO_PLANEJAMENTO/expenses
Authorization: Bearer {{clientToken}}
Content-Type: application/json

{
  "description": "Folha de pagamento",
  "amount": 15000.00,
  "date": "2024-01-20T00:00:00Z",
  "category": "Pessoal"
}

### Deletar receita (Cliente)
DELETE {{baseUrl}}/tax-plans/UUID_DO_PLANEJAMENTO/revenues/UUID_DA_RECEITA
Authorization: Bearer {{clientToken}}

### Deletar despesa (Cliente)
DELETE {{baseUrl}}/tax-plans/UUID_DO_PLANEJAMENTO/expenses/UUID_DA_DESPESA
Authorization: Bearer {{clientToken}}

### Deletar planejamento (Admin)
DELETE {{baseUrl}}/tax-plans/UUID_DO_PLANEJAMENTO
Authorization: Bearer {{adminToken}}


### Criar administrador (Super Admin)
POST http://localhost:3001/api/admin/admins
Authorization: Bearer TOKEN_SUPER_ADMIN
Content-Type: application/json

{
  "name": "Admin Principal",
  "email": "admin@occ.com.br",
  "password": "admin123"
}